# -------------------------
# App Info
# -------------------------
spring.application.name=stayops

# -------------------------
# Server Config
# -------------------------
# Bind to all interfaces so backend is reachable from other devices on LAN
server.address=0.0.0.0
server.port=8080

# -------------------------
# HTTP Configuration
# -------------------------
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true
spring.mvc.contentnegotiation.favor-parameter=false
spring.mvc.contentnegotiation.favor-path-extension=false
spring.mvc.contentnegotiation.media-types.json=application/json
spring.mvc.contentnegotiation.parameter-name=mediaType

# -------------------------
# Database Config (MySQL)
# -------------------------
spring.datasource.url=jdbc:mysql://localhost:3306/StayOps?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=Hello@3126
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.format_sql=true

# -------------------------
# JPA / Hibernate - FIX FOR CONCURRENT MODIFICATION
# -------------------------
# Disable open-in-view to prevent lazy loading during view rendering
spring.jpa.open-in-view=true
# Enable lazy loading outside transaction (use cautiously, better to use @Transactional)
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true

# -------------------------
# Spring Security
# -------------------------
spring.security.user.name=admin
spring.security.user.password=admin

# -------------------------
# File Upload Config
# -------------------------
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# -------------------------
# Cloudinary Config
# -------------------------
cloudinary.cloud_name=di4v3fcqi
cloudinary.api_key=919748897531526
cloudinary.api_secret=BoPIMyYd48FK4QooxmoEU7JEckU

# -------------------------
# JWT Configuration
# -------------------------
jwt.secret=myVerySecretKeyThatIsAtLeast256BitsLongForHS256AlgorithmSecureKey2024
jwt.expiration=86400

# -------------------------
# Email Configuration (Gmail SMTP)
# -------------------------
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=chanmunekp@gmail.com
spring.mail.password=deia luje oicc fniz
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# -------------------------
# Thymeleaf Configuration
# -------------------------
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false
spring.thymeleaf.check-template=true
spring.thymeleaf.check-template-location=true

# -------------------------
# Hotel Email Settings
# -------------------------
app.base-url=http://0.0.0.0:8080
app.hotel-name=StayOps

# -------------------------
# Flyway Database Migration
# -------------------------
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-version=0

# -------------------------
# Automation Configuration
# -------------------------
# Hold & Reservation Management
stayops.automation.hold-ttl-minutes=15
stayops.automation.no-show-grace-period-hours=24
stayops.automation.stale-pending-hours=72
stayops.automation.payment-timeout-minutes=30

# Feature Toggles
stayops.automation.auto-assign-rooms=true
stayops.automation.auto-create-housekeeping=true
stayops.automation.auto-mark-no-shows=true
stayops.automation.auto-confirm-on-payment=true

# Currency & Pricing (Sri Lankan Rupees)
app.currency=LKR
app.currency.symbol=Rs.
app.default.room.price.standard=15000
app.default.room.price.deluxe=25000
app.default.room.price.suite=40000

# Dynamic Pricing Configuration
pricing.enable.dynamic=true
pricing.update.schedule.cron=0 0 3 * * *
pricing.floor.price=10000
pricing.ceiling.price=100000

# Fraud Detection
fraud.detection.enabled=true
fraud.detection.failed.payment.threshold=3
fraud.detection.velocity.check.hours=24
fraud.detection.max.bookings.per.day=5

# OTA Channel Manager
ota.sync.enabled=false
ota.api.url=https://api.channelmanager.example.com
ota.api.key=your-api-key-here
ota.hotel.id=YOUR_HOTEL_ID
ota.sync.availability.cron=0 0 */6 * * *
ota.sync.rates.cron=0 0 4 * * *

# Webhook Configuration
webhook.payment.secret=your-webhook-secret-key-here
webhook.signature.algorithm=HmacSHA256

# -------------------------
# Async & Scheduling Configuration
# -------------------------
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=stayops-async-
spring.task.scheduling.pool.size=5

# -------------------------
# Jackson JSON Configuration
# -------------------------
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC
spring.jackson.default-property-inclusion=non_null

# -------------------------
# Logging Configuration
# -------------------------
logging.level.root=INFO

# Security & Auth Logging
logging.level.com.example.stayops.security=DEBUG
logging.level.com.example.stayops.security.JwtRequestFilter=TRACE
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.web.FilterChainProxy=DEBUG
logging.level.org.springframework.web.cors=DEBUG

# Service Layer Logging
logging.level.com.example.stayops.service=DEBUG
logging.level.com.example.stayops.service.impl.EmailServiceImpl=DEBUG
logging.level.com.example.stayops.controller=DEBUG
logging.level.com.example.stayops.util=DEBUG

# Automation & Scheduling Logging
logging.level.com.example.stayops.automation=INFO
logging.level.com.example.stayops.scheduling=INFO
logging.level.com.example.stayops.event=DEBUG

# Email Logging
logging.level.org.springframework.mail=DEBUG
logging.level.org.thymeleaf=DEBUG

# Database Logging
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# -------------------------
# Development Profile Settings
# -------------------------
spring.profiles.active=dev

# Show detailed error messages in development
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on-param
server.error.include-exception=false

# -------------------------
# Performance & Monitoring
# -------------------------
# Enable actuator endpoints for monitoring
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true

# Connection Pool Settings (HikariCP)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# -------------------------
# Scheduled Job Cron Expressions
# -------------------------
# Format: second minute hour day month weekday
jobs.cron.expired-holds=0 */5 * * * *
jobs.cron.timeout-payments=0 */10 * * * *
jobs.cron.no-shows=0 0 * * * *
jobs.cron.stale-reservations=0 0 */6 * * *
jobs.cron.nightly-audit=0 0 2 * * *
jobs.cron.arrival-reminders=0 0 9 * * *
jobs.cron.dynamic-pricing=0 0 3 * * *

# -------------------------
# Cache Configuration (Optional)
# -------------------------
spring.cache.type=simple
spring.cache.cache-names=rooms,rates,availability

# -------------------------
# Retry Configuration
# -------------------------
retry.max-attempts=3
retry.backoff.initial-interval=1000
retry.backoff.multiplier=2
retry.backoff.max-interval=10000

# -------------------------
# Business Rules Configuration
# -------------------------
business.max-rooms-per-reservation=5
business.max-guests-per-room=4
business.check-in-time=14:00
business.check-out-time=11:00
business.cancellation.free-period-hours=24
business.early-checkin.fee=2000
business.late-checkout.fee=2000

# -------------------------
# Notification Settings
# -------------------------
notification.email.enabled=true
notification.sms.enabled=false
notification.push.enabled=false
notification.reservation.confirmed=true
notification.reservation.reminder=true
notification.payment.success=true
notification.payment.failed=true

# -------------------------
# Audit & Compliance
# -------------------------
audit.log.enabled=true
audit.log.sensitive-data=false
audit.retention.days=365
compliance.gdpr.enabled=true
compliance.pci.enabled=true

# -------------------------
# API Rate Limiting (Optional)
# -------------------------
api.rate-limit.enabled=false
api.rate-limit.requests-per-minute=60
api.rate-limit.requests-per-hour=1000

# -------------------------
# External Service Timeouts
# -------------------------
external.payment.timeout=30000
external.ota.timeout=15000
external.email.timeout=10000

# ========================================================================
# STAYOPS RESERVATION AUTOMATION CONFIGURATION
# ========================================================================
# Add these settings to your application.properties file

# ========================================================================
# SCHEDULING CONFIGURATION
# ========================================================================
# Enable/disable all scheduled jobs
spring.task.scheduling.enabled=true

# ========================================================================
# AUTOMATION SETTINGS
# ========================================================================
# Enable/disable individual automation features
stayops.automation.auto-cancel-unconfirmed=true
stayops.automation.auto-checkout-overdue=true
stayops.automation.auto-checkin-arriving=true
stayops.automation.send-arrival-reminders=true
stayops.automation.archive-old-reservations=true

# Timing configurations (in hours)
stayops.automation.unconfirmed-cancel-hours=3
stayops.automation.checkout-grace-period-hours=12
stayops.automation.checkin-start-hour=14
stayops.automation.archive-after-days=30

# ========================================================================
# NOTIFICATION SETTINGS
# ========================================================================
# Enable/disable notifications for automation events
stayops.automation.notify-guest-on-auto-cancel=true
stayops.automation.notify-staff-on-auto-checkout=true
stayops.automation.notify-guest-arrival-reminder=true

# Email templates
stayops.automation.email.auto-cancel-subject=Your reservation has been cancelled
stayops.automation.email.arrival-reminder-subject=Your check-in is tomorrow!

# SMS settings
stayops.automation.sms.enabled=false
stayops.automation.sms.provider=twilio

# ========================================================================
# AUDIT & LOGGING
# ========================================================================
# Log all automation actions
stayops.automation.audit-logging=true
stayops.automation.log-level=INFO

# Metrics collection
stayops.automation.collect-metrics=true
stayops.automation.metrics-retention-days=90

# ========================================================================
# SAFETY & LIMITS
# ========================================================================
# Maximum auto-cancellations per hour (prevent runaway automation)
stayops.automation.max-cancellations-per-hour=50

# Maximum auto-checkouts per hour
stayops.automation.max-checkouts-per-hour=100

# Require manual approval for high-value reservations
stayops.automation.manual-approval-threshold=500000.00

# ========================================================================
# BUSINESS RULES
# ========================================================================
# Check-in time (24-hour format)
stayops.business.checkin-time=14:00

# Check-out time (24-hour format)
stayops.business.checkout-time=11:00

# Grace period for late checkout (in hours)
stayops.business.late-checkout-grace=2

# Same-day booking auto-confirmation
stayops.business.same-day-auto-confirm=true

# ========================================================================
# INTEGRATION SETTINGS
# ========================================================================
# Integration with other automation systems
stayops.automation.integrate-housekeeping=true
stayops.automation.integrate-payment=true
stayops.automation.integrate-ota=true

# ========================================================================
# DEVELOPMENT/TESTING SETTINGS
# ========================================================================
# Dry-run mode (log actions without executing)
stayops.automation.dry-run=false

# Override current time for testing (ISO format: 2024-01-15T14:30:00)
stayops.automation.test-current-time=

# Fast mode for testing (reduce wait times)
stayops.automation.fast-mode=false

# ========================================================================
# MONITORING & ALERTS
# ========================================================================
# Enable health checks
management.health.automation.enabled=true

# Alert thresholds
stayops.automation.alert.failure-rate-threshold=0.05
stayops.automation.alert.email=ops@stayops.com
stayops.automation.alert.slack-webhook=

# ========================================================================
# EXAMPLE CRON EXPRESSIONS (COMMENTED FOR REFERENCE)
# ========================================================================
# Format: second minute hour day month weekday
# Examples:
# - "0 */30 * * * *"  = Every 30 minutes
# - "0 0 14-23 * * *" = Every hour from 2 PM to 11 PM
# - "0 0 9 * * *"     = Daily at 9 AM
# - "0 0 3 * * SUN"   = Sundays at 3 AM
# - "0 15 * * * *"    = Every hour at :15

# Override cron schedules if needed:
# stayops.automation.cron.unconfirmed-cancel=0 */30 * * * *
# stayops.automation.cron.checkout-overdue=0 15 * * * *
# stayops.automation.cron.checkin-arriving=0 0 14-23 * * *
# stayops.automation.cron.arrival-reminders=0 0 9 * * *
# stayops.automation.cron.archive-old=0 0 3 * * SUN

# ========================================================================
# SAMPLE PROFILE-SPECIFIC SETTINGS
# ========================================================================
# For development: Faster schedules, more logging
# spring.profiles.active=dev
# stayops.automation.cron.unconfirmed-cancel=0 */5 * * * *
# stayops.automation.log-level=DEBUG

# For production: Normal schedules, optimized settings
# spring.profiles.active=prod
# stayops.automation.dry-run=false
# stayops.automation.collect-metrics=true